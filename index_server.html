<!DOCTYPE html>
<html>
<head>
    <title>ë“€ì–¼ ì¹´ë©”ë¼</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            display: flex;
            height: 100vh;
            font-family: Arial, sans-serif;
        }
        
        .left-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .right-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        
        .camera-container {
            flex: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            max-height: 60%;
        }
        
        .bom-container, .work-container {
            flex: 1;
            padding: 20px;
            background-color: #1a1a1a;
            overflow-y: auto;
            max-height: 40%;
            display: flex; 
            flex-direction: column;
        }

        .bom-title, .work-title {
            color: #fff;
            text-align: center;
            margin-bottom: 15px;
            font-size: 18px;
            font-weight: bold;
        }
        
        .bom-table, .work-table {
            width: 100%;
            border-collapse: collapse;
            background-color: #2a2a2a;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            flex-grow: 1; 
        }
        
        .bom-table th, .work-table th {
            background-color: #3a3a3a;
            color: #fff;
            padding: 12px 8px;
            text-align: center;
            font-weight: bold;
            border-bottom: 2px solid #4a4a4a;
            font-size: 14px;
            white-space: nowrap;
        }
        
        .bom-table td, .work-table td {
            color: #ccc;
            padding: 10px 8px;
            border-bottom: 1px solid #3a3a3a;
            font-size: 13px;
            text-align: center;
            white-space: nowrap;
        }
        
        .bom-table tr:hover, .work-table tr:hover {
            background-color: #3a3a3a;
        }
        
        .bom-table tr:last-child td, .work-table tr:last-child td {
            border-bottom: none;
        }
        
        .cls-no {
            background-color: #4a90e2;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            text-align: center;
            min-width: 30px;
            display: inline-block;
        }
        
        .usage {
            font-weight: bold;
            color: #4CAF50;
        }
        
        .detected-count {
            font-weight: bold;
            padding: 4px 8px;
            border-radius: 4px;
            text-align: center;
            min-width: 30px;
            display: inline-block;
        }
        
        .work-seq {
            background-color: #ff9800;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
            text-align: center;
            min-width: 30px;
            display: inline-block;
        }
        
        .work-task {
            font-weight: bold;
            color: #2196F3;
        }
        
        .bom-code {
            background-color: #9C27B0;
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: bold;
        }
        
        .detected-match {
            background-color: #4CAF50;
            color: white;
        }
        
        .detected-mismatch {
            background-color: #f44336;
            color: white;
        }
        
        .detected-zero {
            background-color: #666;
            color: white;
        }
        
        .status-indicator {
            font-size: 16px;
            margin-left: 8px;
        }
        
        img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
        }
        
        .loading {
            color: #999;
            text-align: center;
            padding: 20px;
        }
        
        .error {
            color: #ff6b6b;
            text-align: center;
            padding: 20px;
        }
        
        .last-updated {
            color: #888;
            font-size: 12px;
            text-align: center;
            margin-top: 10px;
        }

        .check-status {
            font-size: 20px; 
            font-weight: bold;
        }

        /* Modal Styles */
        .modal {
            display: none; /* Hidden by default */
            position: fixed; /* Stay in place */
            z-index: 100; /* Sit on top */
            left: 0;
            top: 0;
            width: 100%; /* Full width */
            height: 100%; /* Full height */
            overflow: auto; /* Enable scroll if needed */
            background-color: rgba(0,0,0,0.7); /* Black w/ opacity */
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: #333;
            margin: auto;
            padding: 30px;
            border: 1px solid #888;
            width: 80%; /* Could be more specific */
            max-width: 500px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.5);
            border-radius: 10px;
            text-align: center;
            color: white;
        }

        .modal-content h2 {
            margin-top: 0;
            color: #4CAF50;
            font-size: 24px;
        }

        .modal-content p {
            font-size: 18px;
            margin-bottom: 25px;
        }

        .modal-buttons button {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 0 10px;
            transition: background-color 0.3s ease;
        }

        .modal-buttons button:hover {
            background-color: #45a049;
        }

        .modal-buttons #noBtn {
            background-color: #f44336;
        }

        .modal-buttons #noBtn:hover {
            background-color: #da190b;
        }

        /* ìƒˆë¡œìš´ ì‘ì—… ì§€ì‹œ ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
        .action-message {
            background-color: #2b2b2b; /* ì–´ë‘ìš´ ë°°ê²½ */
            color: #e0e0e0; /* ë°ì€ ê¸€ììƒ‰ */
            padding: 15px;
            margin-top: 20px;
            border-radius: 8px;
            font-size: 16px;
            font-weight: bold;
            text-align: center;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }

        .action-message #actionText {
            color: #FFD700; /* ê°•ì¡° ìƒ‰ìƒ (ê³¨ë“œ) */
        }

    #error-status {
      display: none;
      position: fixed;
      top: 0;
      right: 0;
      background: #d32f2f;
      color: white;
      padding: 12px 16px;
      border-radius: 8px;
      font-weight: bold;
      z-index: 2000;
      box-shadow: 0 0 10px #d32f2f80;
    }

    #alert-status {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: #2a992a;
      color: white;
      padding: 12px 16px;
      border-radius: 8px;
      font-weight: bold;
      z-index: 2000;
      box-shadow: 0 0 10px #11713880;
    }
    </style>
</head>
<body>
    <div class="left-panel">
        <div class="camera-container">
            <img src="/video_feed/0" alt="Camera 0">
        </div>
        <div class="bom-container">
            <div class="bom-title">BOM ë¶€í’ˆ ì •ë³´ ë° ê²€ì¶œ í˜„í™©</div>
            <div id="bomTableContainer">
                <div class="loading">BOM ë°ì´í„° ë¡œë”© ì¤‘...</div>
            </div>
            <div id="lastUpdated" class="last-updated"></div>
            
            <div id="currentActionMessage" class="action-message">
                í˜„ì¬ ì‘ì—… ì§€ì‹œ: <span id="actionText">ì •ë³´ ë¡œë”© ì¤‘...</span>
            </div>
        </div>
    </div>
    
    <div class="right-panel">
        <div class="camera-container">
            <img src="/video_feed/1" alt="Camera 1">
        </div>
        <div class="work-container">
            <div class="work-title">ì‘ì—… ì •ë³´</div>
            <div id="workTableContainer">
                <div class="loading">ì‘ì—… ë°ì´í„° ë¡œë”© ì¤‘...</div>
            </div>
            <div id="workLastUpdated" class="last-updated"></div>
        </div>
    </div>

    <div id="completionModal" class="modal">
        <div class="modal-content">
            <h2>ğŸ‰ ì œí’ˆ ì™„ì„±! ğŸ‰</h2>
            <p>ëª¨ë“  ì‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ìŒ ì‘ì—…ì„ ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?</p>
            <div class="modal-buttons">
                <button id="yesBtn">ì˜ˆ</button>
                <button id="noBtn">ì•„ë‹ˆì˜¤</button>
            </div>
        </div>
    </div>

    <div id="error-status">ì‘ì—… ìˆœì„œ ì˜¤ë¥˜!</div>

    <div id="alert-status">good</div>


    <script>
        let bomData = [];
        let workData = [];
        let currentProcessStep = "waiting_for_match"; 
        let isProcessCompleted = false; // ë°±ì—”ë“œì˜ is_process_completed_flagì™€ ë™ê¸°í™”
        let isFirst = true;


        //hdy
        const alertStatusDiv = document.getElementById("alert-status");
        const errorStatusDiv = document.getElementById("error-status");



        //hdy
        function showErrorMessage(message) {
            errorStatusDiv.textContent = message;
            errorStatusDiv.style.display = "block";
            setTimeout(() => {
                errorStatusDiv.style.display = "none";
            }, 3000);
        }

        function showAlertMessage(message) {
            alertStatusDiv.textContent = message;
            alertStatusDiv.style.display = "block";
            setTimeout(() => {
                alertStatusDiv.style.display = "none";
            }, 3000);
        }

        async function loadBomData() {
            try {
                const response = await fetch('/bom_data');
                const data = await response.json();
                
                if (data.bom_data && data.bom_data.length > 0) {
                    bomData = data.bom_data.filter(item => 
                        item.part_name && item.useage && item.cls_no !== null
                    );
                    updateBomTable();
                } else {
                    document.getElementById('bomTableContainer').innerHTML = 
                        '<div class="error">BOM ë°ì´í„°ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</div>';
                }
            } catch (error) {
                console.error('BOM ë°ì´í„° ë¡œë”© ì˜¤ë¥˜:', error);
                document.getElementById('bomTableContainer').innerHTML = 
                    '<div class="error">BOM ë°ì´í„° ë¡œë”© ì‹¤íŒ¨</div>';
            }
        }
        
        async function loadWorkData() {
            try {
                const response = await fetch('/work');
                const data = await response.json();
                
                workData = data || [];
            } catch (error) {
                console.error('ì‘ì—… ë°ì´í„° ë¡œë”© ì˜¤ë¥˜:', error);
                document.getElementById('workTableContainer').innerHTML = 
                    '<div class="error">ì‘ì—… ë°ì´í„° ë¡œë”© ì‹¤íŒ¨</div>';
            }
        }
        
        async function updateOverallStatus() {
            try {
                const response = await fetch('/full_status');
                const data = await response.json();
                console.log(data)
                updateBomTable(data.detection_counts.counts, data.detection_counts.timestamp);

                currentProcessStep = data.process_status.current_step;
                isProcessCompleted = data.process_status.is_completed; 
                
                console.log('Current Process Step (Frontend):', currentProcessStep, 'Is Completed:', isProcessCompleted);
                
                updateWorkTable();
                updateActionMessage(currentProcessStep, data.camera_status.active_camera); // ìƒˆë¡œ ì¶”ê°€í•  í•¨ìˆ˜ í˜¸ì¶œ

                if (isProcessCompleted && currentProcessStep === "completed") {
                    showCompletionModal();
                }
                
            } catch (error) {
                console.error('ì „ì²´ ìƒíƒœ ë¡œë”© ì˜¤ë¥˜:', error);
                updateBomTable({});
                updateWorkTable();
                updateActionMessage("error"); // ì—ëŸ¬ ì‹œ ë©”ì‹œì§€ í‘œì‹œ
            }
        }
        
        function updateWorkTable() {
            const container = document.getElementById('workTableContainer');
            const lastUpdatedDiv = document.getElementById('workLastUpdated');
            
            if (workData.length === 0) {
                container.innerHTML = '<div class="error">ì‘ì—… ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }
            
            let tableHTML = `
                <table class="work-table">
                    <thead>
                        <tr>
                            <th>ì‘ì—…ìˆœì„œ</th>
                            <th>ì‘ì—…ë‚´ìš©</th>
                            <th>BOMì½”ë“œ</th>
                            <th>ì™„ë£Œ</th> 
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            workData.forEach(item => {
                const workSeq = parseInt(item.work_seq);
                let isChecked = false;
                
                // --- ì´ ë¶€ë¶„ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤! ---
                // Best3 ëª¨ë¸ì´ 3ë²ˆ ì¸ë±ìŠ¤ë¥¼ 'ê°ì§€ ì™„ë£Œ' í–ˆì„ ë•Œ (ì¦‰, step4_check_0_first ë‹¨ê³„ ì§„ì… í›„) ì‘ì—… 1, 2 ì²´í¬
                if (workSeq === 1 || workSeq === 2) { 
                    if (currentProcessStep === "step4_check_0_first" || 
                        currentProcessStep === "step5_check_4" ||
                        currentProcessStep === "step6_check_0_second" ||
                        currentProcessStep === "step7_check_5" ||
                        currentProcessStep === "completed"
                    ) {
                        isChecked = true;
                    }
                } 
                // Best3 ëª¨ë¸ì´ 4ë²ˆ ì¸ë±ìŠ¤ë¥¼ 'ê°ì§€ ì™„ë£Œ' í–ˆì„ ë•Œ (ì¦‰, step6_check_0_second ë‹¨ê³„ ì§„ì… í›„) ì‘ì—… 3 ì²´í¬
                else if (workSeq === 3) {
                    if (currentProcessStep === "step6_check_0_second" || 
                        currentProcessStep === "step7_check_5" ||
                        currentProcessStep === "completed"
                    ) {
                        isChecked = true;
                    }
                } 
                // Best3 ëª¨ë¸ì´ 5ë²ˆ ì¸ë±ìŠ¤ë¥¼ 'ê°ì§€ ì™„ë£Œ' í–ˆì„ ë•Œ (ì¦‰, completed ë‹¨ê³„ ì§„ì… í›„) ì‘ì—… 4 ì²´í¬
                else if (workSeq === 4) {
                    if (currentProcessStep === "completed"
                    ) {
                        isChecked = true;
                    }
                }
                // --- ìˆ˜ì • ë ---
                
                const checkMark = isChecked ? 'âœ…' : 'â¬œ'; 
                
                tableHTML += `
                    <tr>
                        <td><span class="work-seq">${workSeq}</span></td>
                        <td><span class="work-task">${item.work_task}</span></td>
                        <td><span class="bom-code">${item.bom_code}</span></td>
                        <td><span class="check-status">${checkMark}</span></td> 
                    </tr>
                `;
            });
            
            tableHTML += `
                    </tbody>
                </table>
            `;
            
            container.innerHTML = tableHTML;
            lastUpdatedDiv.textContent = `ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ${new Date().toLocaleTimeString()}`;
        }
        
        function updateBomTable(detectionCounts = {}, timestamp = null) {
            const container = document.getElementById('bomTableContainer');
            const lastUpdatedDiv = document.getElementById('lastUpdated');
            
            if (bomData.length === 0) {
                container.innerHTML = '<div class="error">ìœ íš¨í•œ BOM ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</div>';
                return;
            }
            
            let tableHTML = `
                <table class="bom-table">
                    <thead>
                        <tr>
                            <th>í´ë˜ìŠ¤</th>
                            <th>ë¶€í’ˆëª…</th>
                            <th>í•„ìš”ëŸ‰</th>
                            <th>ê²€ì¶œëŸ‰</th>
                            <th>ìƒíƒœ</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            bomData.forEach(item => {
                const clsNo = parseInt(item.cls_no);
                const required = parseInt(item.useage);
                const detected = detectionCounts[clsNo] || 0;
                const isMatch = detected === required;
                
                let detectedClass = 'detected-zero';
                let statusIcon = 'âšª';
                
                if (detected > 0) {
                    if (isMatch) {
                        detectedClass = 'detected-match';
                        statusIcon = 'âœ…';
                    } else {
                        detectedClass = 'detected-mismatch';
                        statusIcon = detected > required ? 'â¬†ï¸' : 'â¬‡ï¸';
                    }
                }
                
                tableHTML += `
                    <tr>
                        <td><span class="cls-no">${clsNo}</span></td>
                        <td>${item.part_name}</td>
                        <td><span class="usage">${required}</span></td>
                        <td><span class="detected-count ${detectedClass}">${detected}</span></td>
                        <td><span class="status-indicator">${statusIcon}</span></td>
                    </tr>
                `;
            });
            
            tableHTML += `
                    </tbody>
                </table>
            `;
            
            container.innerHTML = tableHTML;
            
            if (timestamp) {
                lastUpdatedDiv.textContent = `ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ${timestamp}`;
            } else {
                lastUpdatedDiv.textContent = 'ê²€ì¶œ ë°ì´í„° ì—†ìŒ';
            }
        }

        // ìƒˆë¡œ ì¶”ê°€ëœ í•¨ìˆ˜
        function updateActionMessage(step, activeCamera) {
            const actionTextElement = document.getElementById('actionText');
            let message = "";

            switch(step) {
                case "waiting_for_match":
                    message = "ë¶€í’ˆì˜ ê°œìˆ˜ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.";
                    break;
                case "step1_remove_3":
                    if (activeCamera === 0) { // best_2 ëª¨ë¸
                        if(isFirst){
                            showAlertMessage("BOMì´ ì¼ì¹˜í•©ë‹ˆë‹¤. ì¡°ë¦½ì„ ì‹œì‘í•˜ì„¸ìš”.");
                        }
                        
                        message = "ë¶‰ì€ìƒ‰ ë¸”ë¡ì„ ì¡°ë¦½í•˜ì‹­ì‹œì˜¤."; // 3ë²ˆ ì¸ë±ìŠ¤ ì œê±°
                    }
                    break;
                case "step2_remove_2":
                    if (activeCamera === 0) { // best_2 ëª¨ë¸
                        message = "ì´ˆë¡ìƒ‰ ë¸”ë¡ì„ ì¡°ë¦½í•˜ì‹­ì‹œì˜¤."; // 2ë²ˆ ì¸ë±ìŠ¤ ì œê±°
                    }
                    break;
                case "step3_check_3":
                    if (activeCamera === 1) { // best3 ëª¨ë¸
                        message = "1ë²ˆ, 2ë²ˆ ì‘ì—…ì„ í•˜ì‹­ì‹œì˜¤."; // 3ë²ˆ ì¸ë±ìŠ¤ í™•ì¸
                    }
                    break;
                case "step4_check_0_first":
                    if (activeCamera === 0) { // best_2 ëª¨ë¸
                        message = "íŒŒë€ìƒ‰ ë¸”ë¡ì„ ì¡°ë¦½í•˜ì‹­ì‹œì˜¤."; // 0ë²ˆ ì¸ë±ìŠ¤ 1ê°œ ê°ì†Œ
                    }
                    break;
                case "step5_check_4":
                    if (activeCamera === 1) { // best3 ëª¨ë¸
                        message = "3ë²ˆ ì‘ì—…ì„ í•˜ì‹­ì‹œì˜¤."; // 4ë²ˆ ì¸ë±ìŠ¤ í™•ì¸
                    }
                    break;
                case "step6_check_0_second":
                    if (activeCamera === 0) { // best_2 ëª¨ë¸
                        message = "íŒŒë€ìƒ‰ ë¸”ë¡ì„ ì¡°ë¦½í•˜ì‹­ì‹œì˜¤."; // 0ë²ˆ ì¸ë±ìŠ¤ ì¶”ê°€ 1ê°œ ê°ì†Œ
                    }
                    break;
                case "step7_check_5":
                    if (activeCamera === 1) { // best3 ëª¨ë¸
                        message = "4ë²ˆ ì¡°ë¦½ì„ í•˜ì‹­ì‹œì˜¤."; // 5ë²ˆ ì¸ë±ìŠ¤ í™•ì¸
                    }
                    break;
                case "completed":
                    message = "ëª¨ë“  ì‘ì—…ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!";
                    break;
                default:
                    message = "í˜„ì¬ ì‘ì—… ì •ë³´ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘...";
                    break;
            }

            actionTextElement.textContent = message;
        }

        // ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜
        const completionModal = document.getElementById('completionModal');
        const yesBtn = document.getElementById('yesBtn');
        const noBtn = document.getElementById('noBtn');

        function showCompletionModal() {
            completionModal.style.display = 'flex'; // flexë¡œ ì„¤ì •í•˜ì—¬ ì¤‘ì•™ ì •ë ¬ ìœ ì§€
        }

        function hideCompletionModal() {
            completionModal.style.display = 'none';
        }

        async function resetProcess() {
            try {
                const response = await fetch('/reset_process', { method: 'POST' }); // POST ìš”ì²­
                if (response.ok) {
                    console.log('í”„ë¡œì„¸ìŠ¤ ì´ˆê¸°í™” ìš”ì²­ ì„±ê³µ');
                    hideCompletionModal(); // ëª¨ë‹¬ ë‹«ê¸°
                    // ê°•ì œ ìƒˆë¡œê³ ì¹¨ ëŒ€ì‹  ìƒíƒœë§Œ ì—…ë°ì´íŠ¸í•˜ë„ë¡ ë³€ê²½ (í•„ìš” ì‹œ ìƒˆë¡œê³ ì¹¨ í™œì„±í™”)
                    await updateOverallStatus(); // ìƒíƒœë¥¼ ì¦‰ì‹œ ì—…ë°ì´íŠ¸
                } else {
                    console.error('í”„ë¡œì„¸ìŠ¤ ì´ˆê¸°í™” ìš”ì²­ ì‹¤íŒ¨');
                    alert('í”„ë¡œì„¸ìŠ¤ ì´ˆê¸°í™”ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
                }
            } catch (error) {
                console.error('í”„ë¡œì„¸ìŠ¤ ì´ˆê¸°í™” API í˜¸ì¶œ ì˜¤ë¥˜:', error);
                alert('í”„ë¡œì„¸ìŠ¤ ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
            }
        }

        yesBtn.onclick = resetProcess; // "ì˜ˆ" ë²„íŠ¼ í´ë¦­ ì‹œ í”„ë¡œì„¸ìŠ¤ ì´ˆê¸°í™”
        noBtn.onclick = hideCompletionModal; // "ì•„ë‹ˆì˜¤" ë²„íŠ¼ í´ë¦­ ì‹œ ëª¨ë‹¬ë§Œ ë‹«ê¸°

        window.addEventListener('DOMContentLoaded', async () => {
            await loadBomData();
            await loadWorkData();
            await updateOverallStatus(); 
        });
        
        // 2ì´ˆë§ˆë‹¤ ìƒíƒœ ì—…ë°ì´íŠ¸
        setInterval(() => {
            // í”„ë¡œì„¸ìŠ¤ê°€ ì™„ë£Œ ìƒíƒœê°€ ì•„ë‹ˆê±°ë‚˜, ì™„ë£Œ ìƒíƒœì´ì§€ë§Œ ëª¨ë‹¬ì´ ì•„ì§ ë– ìˆì§€ ì•Šìœ¼ë©´ ê³„ì† ì—…ë°ì´íŠ¸
            // ì´ë ‡ê²Œ í•˜ë©´ ëª¨ë‹¬ì´ ëœ¨ë©´ ì—…ë°ì´íŠ¸ê°€ ì ì‹œ ë©ˆì¶”ê³  ì‚¬ìš©ìê°€ ì‘ë‹µí•  ë•Œê¹Œì§€ ê¸°ë‹¤ë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
            if (!isProcessCompleted || completionModal.style.display === 'none') {
                updateOverallStatus(); 
            }
        }, 2000); 
        
    </script>
</body>
</html>